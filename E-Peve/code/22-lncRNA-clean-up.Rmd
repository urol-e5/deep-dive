---
title: "22-lncRNA-clean-up"
author: "Zach Bengtsson"
date: "2025-07-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Remove Duplicates

Remove duplicates in BED file from output folder
```{bash}
awk '!seen[$0]++' ~/github/deep-dive/E-Peve/output/Peve_lncRNA.bed > ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA_de-duplicated.bed

```

```{bash}
wc -l ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA_de-duplicated.bed
```

7131 after removing duplicates

# Shift BED positions over by 1

```{bash}
awk '{
  $2 = $2 + 1;
  $3 = $3 + 1;
  print
}' OFS='\t' ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA_de-duplicated.bed > ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA.bed

```

```{bash}
head ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA.bed
tail ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA.bed
```

ctrl+F in bed produced 0 occurences of -1 positions

```{bash}
echo "Negative start coordinates:" 
awk '$2 < 0' ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA.bed
```

# Subset new FASTA

Download genomic fasta
```{bash}
# Navigate to your desired download directory
cd ~/github/deep-dive/E-Peve/data/22-lncRNA-clean-up

# Use wget to download only .sorted.bam files
wget "https://gannet.fish.washington.edu/seashell/snaps/Porites_evermanni_v1.fa"


```


Subset original genomic FASTA with new bed file to obstain FASTA of lncRNAs
```{bash}
/home/shared/bedtools2/bin/bedtools getfasta \
-fi ~/github/deep-dive/E-Peve/data/22-lncRNA-clean-up/Porites_evermanni_v1.fa \
-bed ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA.bed \
-fo ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA.fasta

```

Many errors like this:

Feature (Porites_evermani_scaffold_1014:160340-162434) beyond the length of Porites_evermani_scaffold_1014 size (162433 bp).  Skipping.
Feature (Porites_evermani_scaffold_1037:155955-159872) beyond the length of Porites_evermani_scaffold_1037 size (159871 bp).  Skipping.

```{bash}
grep -c '^>' ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA.fasta
head ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA.fasta
tail ~/github/deep-dive/E-Peve/output/22-lncRNA-clean-up/Pevermanni_lncRNA.fasta
```
Ran this code and the final count is 6956, which is not the same number of entries in the bed file.


