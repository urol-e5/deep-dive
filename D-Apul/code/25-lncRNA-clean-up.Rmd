---
title: "25-lncRNA-clean-up"
author: "Zach Bengtsson"
date: "2025-07-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Remove Duplicates

Remove duplicates in BED file from 05.33-lncRNA-discovery-overview output folder
```{bash}
awk '!seen[$0]++' ~/github/deep-dive/D-Apul/output/05.33-lncRNA-discovery/Apul_lncRNA.bed > ~/github/deep-dive/D-Apul/output/25-lncRNA-clean-up/Apulchra_lncRNA_de-duplicated.bed

```

```{bash}
wc -l ~/github/deep-dive/D-Apul/output/25-lncRNA-clean-up/Apulchra_lncRNA_de-duplicated.bed
```

16028 after removing duplicates

# Shift BED positions over by 1

```{bash}
awk '{
  $2 = $2 + 1;
  $3 = $3 + 1;
  if ($2 < 0) $2 = 0;
  if ($3 < 0) $3 = 0;
  print
}' OFS='\t' ~/github/deep-dive/D-Apul/output/25-lncRNA-clean-up/Apulchra_lncRNA_de-duplicated.bed > ~/github/deep-dive/D-Apul/output/25-lncRNA-clean-up/Apulchra_lncRNA.bed

```

```{bash}
head ~/github/deep-dive/D-Apul/output/25-lncRNA-clean-up/Apulchra_lncRNA.bed
tail ~/github/deep-dive/D-Apul/output/25-lncRNA-clean-up/Apulchra_lncRNA.bed
```

ctrl+F in bed produced 0 occurences of -1 positions

# Subset new FASTA

Subset original genomic FASTA with new bed file to obstain FASTA of lncRNAs
```{bash}
/home/shared/bedtools2/bin/bedtools getfasta \
-fi ~/github/deep-dive/D-Apul/data/05.34-lncRNA-discovery-overview/GCF_013753865.1_Amil_v2.1_genomic.fna \
-bed ~/github/deep-dive/D-Apul/output/25-lncRNA-clean-up/Apulchra_lncRNA.bed \
-fo ~/github/deep-dive/D-Apul/output/25-lncRNA-clean-up/Apulchra_lncRNA.fasta

```

```{bash}
grep -c '>' ~/github/deep-dive/D-Apul/output/25-lncRNA-clean-up/Apulchra_lncRNA.fasta
head ~/github/deep-dive/D-Apul/output/25-lncRNA-clean-up/Apulchra_lncRNA.fasta
tail ~/github/deep-dive/D-Apul/output/25-lncRNA-clean-up/Apulchra_lncRNA.fasta
```
Ran this code and the final count is 16018, which is not the same number of entries in the bed file.


